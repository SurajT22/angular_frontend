import{c as Re,d as Ce,e as fe}from"./chunk-EKYQSE3Q.js";import{a as ve,b as Se,c as De,d as Ee,e as be}from"./chunk-X2NLI3TS.js";import{a as _e}from"./chunk-IL3CHBM2.js";import"./chunk-TF5BNQMD.js";import"./chunk-X4CEJGGW.js";import"./chunk-XWJPI5P5.js";import{a as ge}from"./chunk-DD65RJ7C.js";import{a as he}from"./chunk-XX5VUOZJ.js";import{a as ce}from"./chunk-TJBFEVGI.js";import{$a as ee,Aa as r,Ba as w,Bb as ie,Db as ne,F as M,Fa as S,Ga as d,Ha as h,Hb as q,J as Y,Ka as J,Ma as P,N as g,Na as l,O as E,Oa as D,Pa as T,Ra as K,Sa as b,T as f,Ta as Q,U as _,Wa as X,Wb as ae,Xb as B,Ya as L,_a as Z,_b as re,bc as oe,cc as pe,dc as se,ec as I,fc as le,ga as s,gc as de,ja as x,la as y,ma as O,mc as ue,na as c,qa as j,qc as F,r as N,rb as te,ta as v,tc as me,ua as R,wa as $,xa as G,ya as W,za as o}from"./chunk-BSMU7QB4.js";var A=class{constructor(){this.FileData=[],this.TotalData="0"}};function Ne(e,t){if(e&1&&(o(0,"tr")(1,"td",9),l(2),r(),o(3,"td",10),l(4),r(),o(5,"td",11),l(6),r(),o(7,"td",9),l(8),r(),o(9,"td",9),l(10),r(),o(11,"td",10),l(12),r()()),e&2){let p=t.$implicit;s(2),D(p.DateTime),s(2),D(p.UserName),s(2),D(p.Activity),s(2),D(p.CurrentValue),s(2),D(p.PreviousValue),s(2),D(p.BatchName)}}var Me=(e,t,p)=>({itemsPerPage:e,currentPage:t,totalItems:p}),Ae=(()=>{let t=class t extends B{constructor(){super(),this.pageChange=new x,this.auditReport=new A}ngOnInit(){}onPageChange(n){this.pageChange.emit(n)}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=E({type:t,selectors:[["app-list-audit-report"]],inputs:{auditReport:"auditReport",currentPage:"currentPage",pageSize:"pageSize",totalCount:"totalCount"},outputs:{pageChange:"pageChange"},standalone:!0,features:[y,b],decls:28,vars:12,consts:[[1,"table-responsive","mt-3"],[1,"table","oee-custom-table","table-responsive","text-center"],["width","150",1,"text-center"],["width","100",1,"text-center"],[1,"page-header","border-0"],[1,"page-header-inner","footer","justify-content-start"],[1,"left"],[1,"right","ms-auto"],[3,"pageChange"],["width","150"],["width","100"],["width","200"]],template:function(a,i){a&1&&(o(0,"div",0)(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),l(5,"DateTime"),r(),o(6,"th",3),l(7,"UserName"),r(),o(8,"th",2),l(9,"Activity"),r(),o(10,"th",2),l(11,"CurrentValue"),r(),o(12,"th",2),l(13,"PreviousValue"),r(),o(14,"th",3),l(15,"Batch"),r()()(),o(16,"tbody"),G(17,Ne,13,6,"tr",null,$),L(19,"paginate"),r()()(),o(20,"div",4)(21,"div",5)(22,"div",6)(23,"span"),l(24),L(25,"paginationCount"),r()(),o(26,"div",7)(27,"app-pagination",8),d("pageChange",function(m){return i.onPageChange(m)}),r()()()()),a&2&&(s(17),W(Z(19,1,i.auditReport.FileData,X(8,Me,i.pageSize,i.currentPage,i.totalCount))),s(7),T(" ",ee(25,4,i.currentPage,i.pageSize,i.totalCount)," "))},dependencies:[q,De,Ee,Se,ve],styles:[".oee-custom-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{height:calc(100vh - 312px)!important}"]});let e=t;return e})();var V=class{constructor(t){Object.assign(this,t)}parse(t){if(!t)return this;let p=t.split("-");if(p.length!=2)return this;let n=p[0].split("_");if(n.length!=3)return this;let a=p[1].split("_");return a.length!=3?this:(this.start=new Date(new Date(new Date().setFullYear(parseInt(n[2]),parseInt(n[1])-1,parseInt(n[0]))).setHours(0,0,0)),this.end=new Date(new Date(new Date().setFullYear(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0]))).setHours(23,59,59)),this)}toString(){return!this.start&&!this.end?"":`${this.convertDate(this.start)}-${this.convertDate(this.end)}`}convertDate(t){function p(a){return a<10?`0${a}`:a}let n=t;return[p(n.getDate()),p(n.getMonth()+1),n.getFullYear()].join("_")}isValidRange(){return this.start&&this.end&&this.end>=this.start}};function Te(e,t){e&1&&(o(0,"span",9),l(1," * "),r())}function qe(e,t){if(e&1){let p=S();o(0,"span",10),d("click",function(){f(p);let a=h();return _(a.clearDateRange())}),o(1,"span",11),l(2,"\xD7"),r()()}}function Be(e,t){e&1&&(o(0,"span"),l(1,"This field is required."),r())}function Ie(e,t){if(e&1&&(o(0,"div",12),v(1,Be,2,0,"span"),r()),e&2){h();let p=P(7);s(1),R(1,p.hasError("required")?1:-1)}}var Fe=()=>({showWeekNumbers:!1,rangeInputFormat:"DD MMM YYYY",dateInputFormat:"DD MMM YYYY",isAnimated:!0,adaptivePosition:!0}),xe=(()=>{let t=class t{constructor(){this.label="",this.required=!1,this.placeholder="",this.dateRangeChange=new x,this.onRangeChange=new x,this.uniqueId="id"+Math.random().toString(36).substring(5),this.inputRange=[],this._showClearBtn=!1}get dateRange(){return this._dateRange}set dateRange(n){n?(this._dateRange=n,this.setDisplayDate()):this.inputRange=[]}get showClearBtn(){return this._showClearBtn}set showClearBtn(n){this._showClearBtn=n&&!this.required}setDisplayDate(){!this.dateRange||!this.dateRange.isValidRange()||(this.showClearBtn=!0,this.inputRange=[new Date(this.dateRange?.start),new Date(this.dateRange?.end)])}onDateRangeChange(){this.dateRange==null&&(this.dateRange=new V),this.dateRange.start=new Date(this.inputRange[0].setHours(0,0,0)),this.dateRange.end=new Date(this.inputRange[1].setHours(23,59,59)),this.dateRangeChange.emit(this.dateRange),this.onRangeChange.emit(this.dateRange)}clearDateRange(){this._dateRange=null,this.dateRange=null,this.dateRangeChange.emit(this.dateRange),this.onRangeChange.emit(this.dateRange)}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=E({type:t,selectors:[["app-date-range"]],inputs:{label:"label",required:"required",placeholder:"placeholder",dateRange:"dateRange",showClearBtn:"showClearBtn"},outputs:{dateRangeChange:"dateRangeChange",onRangeChange:"onRangeChange"},standalone:!0,features:[K([],[{provide:oe,useExisting:I}]),b],decls:12,vars:11,consts:[[1,"field"],["class","text-danger text-bold"],[1,"input-control","has-icon"],["type","text","bsDaterangepicker","",1,"input",3,"name","ngModel","required","bsConfig","placeholder","ngModelChange"],["daterangepicker","bsDaterangepicker","daterange","ngModel"],[1,"form-icon-right",3,"click"],["class","date-clearable","tooltip","Clear"],["aria-hidden","true",1,"mdi","mdi-calendar-blank"],["class","error-msg-text"],[1,"text-danger","text-bold"],["tooltip","Clear",1,"date-clearable",3,"click"],["aria-hidden","true"],[1,"error-msg-text"]],template:function(a,i){if(a&1){let C=S();o(0,"div",0)(1,"label"),l(2),v(3,Te,2,0,"span",1),r(),o(4,"div",2)(5,"input",3,4),d("ngModelChange",function(H){return i.inputRange=H})("ngModelChange",function(){return i.onDateRangeChange()}),r(),o(8,"div",5),d("click",function(){f(C);let H=P(6);return _(H.toggle())}),v(9,qe,3,0,"span",6),w(10,"i",7),r(),v(11,Ie,2,1,"div",8),r()()}if(a&2){let C=P(6),m=P(7);s(2),T(" ",i.label," "),s(1),R(3,i.required?3:-1),s(2),J("name",i.uniqueId),c("ngModel",i.inputRange)("required",i.required)("bsConfig",Q(10,Fe))("placeholder",i.placeholder),s(3),O("aria-expanded",C.isOpen),s(1),R(9,i.showClearBtn?9:-1),s(2),R(11,m.invalid&&(m.dirty||m.touched)?11:-1)}},dependencies:[F,re,pe,ue,le,fe,Re,Ce]});let e=t;return e})();var u=function(e){return e[e.USER_NAME=0]="USER_NAME",e[e.DATE=1]="DATE",e[e.BATCH_NAME=2]="BATCH_NAME",e}(u||{});var k=class{constructor(t){Object.assign(this,t)}};var U=class{};var we=(()=>{let t=class t{constructor(){this.apiReportService=g(be),this.loaderService=g(ae),this.alertService=g(me)}getAuditPageData(){return this.loaderService.show(),this.apiReportService.getAuditReportPageData().pipe(N(n=>n))}viewAuditReport(n){return this.loaderService.show(),this.apiReportService.viewAuditReport(n).pipe(N(a=>a))}exportAuditReport(n){return this.loaderService.show(),this.apiReportService.exportAuditReport(n).pipe(N(a=>{var i=`${this.apiReportService.exportPath}${a.ReportPath}`;return i}))}};t.\u0275fac=function(a){return new(a||t)},t.\u0275prov=Y({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Ve(e,t){if(e&1){let p=S();o(0,"div",5)(1,"app-date-range",17),d("dateRangeChange",function(a){f(p);let i=h();return _(i.dateRange=a)}),r()()}if(e&2){let p=h();s(1),c("label","Date Range")("dateRange",p.dateRange)}}function ke(e,t){if(e&1){let p=S();o(0,"div",5)(1,"div",6)(2,"label"),l(3," User Name "),r(),o(4,"app-ng-select",18),d("valueChange",function(a){f(p);let i=h();return _(i.userName=a)}),r()()()}if(e&2){let p=h();s(4),c("items",p.auditReportPageData.UserName)("value",p.userName)("required",!0)}}function Ue(e,t){if(e&1){let p=S();o(0,"div",5)(1,"div",6)(2,"label"),l(3," Batch "),r(),o(4,"app-ng-select",18),d("valueChange",function(a){f(p);let i=h();return _(i.batchName=a)}),r()()()}if(e&2){let p=h();s(4),c("items",p.auditReportPageData.BatchName)("value",p.batchName)("required",!0)}}var Pe=(()=>{let t=class t extends B{get currentPage(){return this.auditReportReq?.StartIndex?parseInt(this.auditReportReq.StartIndex):0}get pageSize(){return this.auditReportReq?.PageSize?parseInt(this.auditReportReq.PageSize):0}get totalCount(){return this.auditReporRes?.TotalData?parseInt(this.auditReporRes.TotalData):0}constructor(){super(),this.activatedRoute=g(ie),this.auditReportService=g(we),this.datePipe=g(te),this.router=g(ne),this.reportSelectionEnum=u,this.reportTypeList=[{label:"User Name",value:u.USER_NAME},{label:"Date",value:u.DATE},{label:"Batch Name",value:u.BATCH_NAME}],this.reportSelection=u.USER_NAME,this.auditReportPageData=new U,this.auditReportReq=new k({StartIndex:"1",PageSize:"15"}),this.auditReporRes=new A,this.getAuditReportPageData()}ngOnInit(){}getAuditReportPageData(){this.auditReportService.getAuditPageData().pipe(M(this.destroy$)).subscribe(n=>{this.auditReportPageData.BatchName=["All",...n.BatchName],this.auditReportPageData.Station=["All",...n.Station],this.auditReportPageData.UserName=["All",...n.UserName]})}onViewBtnClick(){this.prepareAuditReportReq(),this.filterAsync()}filterAsync(){this.auditReportService.viewAuditReport(this.auditReportReq).pipe(M(this.destroy$)).subscribe(n=>{this.auditReporRes=n})}prepareAuditReportReq(){this.auditReportReq.EventFilter="Audit",this.reportSelection==u.USER_NAME&&this.userName=="All"||this.reportSelection!=u.USER_NAME?this.auditReportReq.UserName="":this.reportSelection==u.USER_NAME&&(this.auditReportReq.UserName=this.userName),this.reportSelection==u.BATCH_NAME&&this.batchName=="All"||this.reportSelection!=u.BATCH_NAME?this.auditReportReq.BatchName="":this.reportSelection==u.BATCH_NAME&&(this.auditReportReq.BatchName=this.batchName),this.reportSelection==u.DATE?(this.auditReportReq.StartDate=this.datePipe.transform(this.dateRange.start,"dd/MM/yy HH:mm:ss"),this.auditReportReq.EndDate=this.datePipe.transform(this.dateRange.end,"dd/MM/yy HH:mm:ss")):(this.auditReportReq.StartDate="",this.auditReportReq.EndDate="")}onExportClick(){var n={StartPage:"",EndPage:"",ReportFormat:"PDF",BatchName:this.auditReportReq.BatchName,StartDate:this.auditReportReq.StartDate,EndDate:this.auditReportReq.EndDate,EventFilter:this.auditReportReq.EventFilter,UserName:this.auditReportReq.UserName};this.auditReportService.exportAuditReport(n).pipe(M(this.destroy$)).subscribe(a=>{window.open(a)})}pageChange(n){this.auditReportReq.StartIndex=n.toString(),this.filterAsync()}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=E({type:t,selectors:[["app-audit-report"]],standalone:!0,features:[y,b],decls:26,vars:19,consts:[[3,"headerLabel"],[1,"mx-2"],["prefixForm","ngForm"],[1,"form-fieldset"],[1,"row"],[1,"col-12","col-md-4","col-lg-4","col-sm-4"],[1,"field"],[1,"col-12",3,"required","items"],[1,"col-12",3,"items","bindLabel","bindValue","value","valueChange"],["class","col-12 col-md-4 col-lg-4 col-sm-4"],[1,"form-header","p-0","m-0","border-0"],[1,"form-header-inner","justify-content-center"],[1,"center"],[1,"two-button"],[3,"btnLabel","btnClick"],[3,"btnLabel","disabled","btnClick"],[3,"auditReport","currentPage","pageSize","totalCount","pageChange"],[3,"label","dateRange","dateRangeChange"],[1,"col-12",3,"items","value","required","valueChange"]],template:function(a,i){a&1&&(w(0,"app-page-header",0),o(1,"div",1)(2,"form",null,2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label"),l(9," Station "),r(),w(10,"app-ng-select",7),r()(),o(11,"div",5)(12,"div",6)(13,"label"),l(14," Report Selection "),r(),o(15,"app-ng-select",8),d("valueChange",function(m){return i.reportSelection=m}),r()()(),v(16,Ve,2,2,"div",9)(17,ke,5,3,"div",9)(18,Ue,5,3,"div",9),r(),o(19,"div",10)(20,"div",11)(21,"div",12)(22,"div",13)(23,"app-form-btn-pr",14),d("btnClick",function(){return i.onViewBtnClick()}),r(),o(24,"app-btn-pr",15),d("btnClick",function(){return i.onExportClick()}),r()()()()()()()(),o(25,"app-list-audit-report",16),d("pageChange",function(m){return i.pageChange(m)}),r()),a&2&&(c("headerLabel","Audit Report Details"),s(10),c("required",!0)("items",i.auditReportPageData.Station),s(5),c("items",i.reportTypeList)("bindLabel","label")("bindValue","value")("value",i.reportSelection),s(1),R(16,i.reportSelection==i.reportSelectionEnum.DATE?16:-1),s(1),R(17,i.reportSelection==i.reportSelectionEnum.USER_NAME?17:-1),s(1),R(18,i.reportSelection==i.reportSelectionEnum.BATCH_NAME?18:-1),s(5),c("btnLabel","View"),s(1),j("footer-btn"),c("btnLabel","Export")("disabled",!(i.auditReporRes.FileData&&i.auditReporRes.FileData.length>0)),s(1),c("auditReport",i.auditReporRes)("currentPage",i.currentPage)("pageSize",i.pageSize)("totalCount",i.totalCount))},dependencies:[Ae,q,ce,F,de,se,I,he,xe,ge,_e]});let e=t;return e})();var Jt=[{path:"",component:Pe}];export{Jt as AuditReport_ROUTES};
